{"version":3,"sources":["Login.tsx","modules/GraphViz/graphQL/expandScope.tsx","modules/GraphViz/calculations/node/nodeCalcs.tsx","modules/GraphViz/calculations/link/linkCalcs.tsx","modules/GraphViz/graphColoring/coloring.tsx","modules/GraphViz/graph/mergeGraphs.tsx","modules/GraphViz/graph/graph_traverse.tsx","modules/GraphViz/graphQL/graphQLAdjacencyMatrix.tsx","modules/GraphViz/graph/labels.tsx","components/GraphViz.tsx","components/NodeTable.tsx","components/SideBarContent.tsx","components/SideBar.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["engagement_edge","window","location","host","checkLogin","a","fetch","method","credentials","res","json","body","LogIn","props","className","initialValues","userName","password","onSubmit","values","sha256WithPepper","loginSuccess","login","alert","console","log","warn","name","type","placeholder","sha256","message","msgBuffer","TextEncoder","encode","crypto","subtle","digest","hashBuffer","hashArray","Array","from","Uint8Array","map","b","toString","slice","join","port","username","hashed","i","JSON","stringify","headers","calcNodeRiskPercentile","_nodeRisk","_allRisks","nodeRisk","risk","allRisks","n","sort","undefined","length","riskIndex","Math","floor","findNode","id","nodes","node","calcLinkRiskPercentile","link","Graph","linkRisk","srcNode","source","dstNode","target","error","srcRisk","dstRisk","round","calcLinkRisk","BKDRHash","str","hash","MAX_SAFE_INTEGER","parseInt","charCodeAt","calcNodeRgb","colorHash","nodeType","rgb","percentToColor","percentile","calcLinkColor","graphql_edge","hostname","retrieveGraph","lens","query","expandScope","then","data","lens_scope","lensName","mergeNodes","x","y","merged","mapNodeProps","prop","Object","prototype","hasOwnProperty","call","mergeGraphs","curGraph","update","links","outputGraph","updated","Map","set","uid","newNode","get","label","newLink","newLinkSource","newLinkTarget","mapEdges","f","isArray","neighbor","mapEdgeProps","getNodeType","t","dgraph_type","node_type","randomInt","min","max","random","graphQLAdjacencyMatrix","inputGraph","traverseNeighbors","callback","edgeName","fromNode","toNode","push","traverseNodes","_","nodeLabel","_node","process_name","process_id","file_path","external_ip","getNodeLabel","strippedNode","analyzer_names","risks","risk_score","analyzer_name","edge","HSL2RGB","H","S","L","q","p","color","o","ColorHash","options","hsl","hueRanges","range","apply","LS","lightness","saturation","param","concat","this","hue","updateGraph","state","setState","scope","mergeUpdate","graphData","curLensName","catch","e","GraphDisplay","setCurNode","React","useState","defaultGraphDisplayState","forceRef","useRef","useEffect","current","d3Force","d3","forEach","abs","vx","vy","interval","setInterval","clearInterval","enableNodeDrag","linkDirectionalParticles","linkDirectionalParticleWidth","linkRiskPercentile","calcLinkParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleSpeed","onNodeClick","event","linkDirectionalArrowLength","linkWidth","linkDirectionalArrowRelPos","riskPercentile","calcLinkDirectionalArrowRelPos","linkCanvasObjectMode","linkCanvasObject","ctx","start","end","textPos","assign","c","relLink","maxTextLength","sqrt","pow","LABEL_NODE_MARGIN","textAngle","atan2","PI","mapLabel","font","fontSize","measureText","width","textWidth","bckgDimensions","save","translate","rotate","fillStyle","fillRect","textAlign","textBaseline","fillText","restore","nodeCanvasObject","globalScale","NODE_R","nodeSize","beginPath","arc","nodeColors","riskColor","fill","nodeRbg","ref","useStyles","makeStyles","root","table","minWidth","tableHeader","NodeTable","classes","hidden","Set","_neighbor","add","displayNode","propName","has","includes","Date","toLocaleString","TableContainer","Table","styles","TableHead","TableRow","TableCell","align","innerTable","TableBody","entries","entry","key","value","button","backgroundColor","title","icon","margin","expand","header","display","SelectLens","component","Button","onClick","setLens","score","ToggleLensTable","toggled","lenses","getLenses","response","aria-label","Number","lens_name","Divider","getEngagementEdge","errors","jres","NodeDetails","ToggleNodeTable","curNode","toggle","SideBarContent","theme","createStyles","appBar","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","marginLeft","easeOut","enteringScreen","menuButton","marginRight","spacing","hide","drawer","flexShrink","drawerPaper","drawerHeader","alignItems","padding","mixins","toolbar","justifyContent","content","flexGrow","contentShift","close","SideBar","curLens","open","setOpen","AppBar","position","clsx","Toolbar","IconButton","Typography","variant","noWrap","Drawer","anchor","paper","paragraph","EngagementUx","redirectTo","routeState","setRouteState","page_name","curPage","localStorage","setItem","Router","getItem","lastCheckLoginCheck","now","loggedIn","App","Boolean","match","darkTheme","createMuiTheme","palette","primary","main","rootElement","document","getElementById","ReactDOM","render","StrictMode","ThemeProvider","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.53a7fb3a.chunk.js","sourcesContent":["import React from 'react';\nimport './LogIn.css';\n// import axios from 'axios';\nimport {Field, Form, Formik} from \"formik\";\nimport {LoginProps} from '../src/modules/GraphViz/CustomTypes'\n\nconst isLocal = true;\n\nconst getEngagementEdge = () => {\n    if (isLocal) {\n        return window.location.host + \":8900/\"\n    } else {\n        return \"__engagement_ux_standin__hostname__\"\n    }\n}\n\nconst engagement_edge = getEngagementEdge();\nexport const checkLogin = async () => {\n    const res = await fetch(`${engagement_edge}checkLogin`, {\n        method: 'get',\n        credentials: 'include',\n    });\n\n    const body = await res.json();\n\n    return body['success'] === 'True';\n};\n\nexport const LogIn = (props: LoginProps) => {\n  return (\n    <div className = \"backgroundImage\">\n      <div className=\"grapl\">Grapl</div>\n      <div className = \"formContainer\">\n      <Formik\n        initialValues={{ userName: \"\", password: \"\" }}\n        onSubmit={async values => {\n          const password = await sha256WithPepper(\n            values.userName, values.password\n          );\n\n          const loginSuccess = login(values.userName, password);\n          alert(loginSuccess)\n          if (loginSuccess) {\n            props.loginSuccess();\n            console.log(\"Logged in\");\n          } else {\n            console.warn(\"Login failed!\")\n          }\n        }}\n      >\n        <Form>\n          <Field name=\"userName\" type=\"text\" placeholder=\"Username\" /> <br/>\n          <Field name=\"password\" type=\"password\" placeholder=\"Password\"/> <br/>\n          <button className=\"submitBtn\"  type=\"submit\">Submit</button>\n        </Form>\n      </Formik>\n        \n      </div>\n    </div>\n  );\n}\n\nasync function sha256(message: string) {\n  // encode as UTF-8\n  const msgBuffer = new TextEncoder().encode(message);\n\n  // hash the message\n  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);\n\n  // convert ArrayBuffer to Array\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n\n  // convert bytes to hex string\n  return hashArray.map(b => ('00' + b.toString(16)).slice(-2)).join('');\n}\n\n\nconst sha256WithPepper = async (username: string, password: string) => {\n  // The pepper only exists to prevent rainbow tables for extremely weak passwords\n  // Client side hashing itself is only to prevent cases where the password is\n  // exposed before it makes it into the password database\n  const pepper = \"f1dafbdcab924862a198deaa5b6bae29aef7f2a442f841da975f1c515529d254\";\n  let hashed = await sha256(password + pepper + username);\n\n  for (let i = 0; i < 5000; i++) {\n      hashed = await sha256(hashed)\n  }\n  return hashed\n};\n\nconst login = async (username: string, password: string) => {\n      try {\n          const res = await fetch(`${engagement_edge}login`, {\n              method: 'post',\n              body: JSON.stringify({\n                  'username': username,\n                  'password': password\n              }),\n              headers: {\n                  'Content-Type': 'application/json',\n              },\n              credentials: 'include',\n          });\n          \n          const body = await res.json();\n          return body['success'] === 'True';\n        } catch (e) {\n          console.log(e);\n          return false\n      }\n    };\n\n// export default LogIn;\n","import {BaseNode, LensScopeResponse} from '../../GraphViz/CustomTypes'\n\nconst isLocal = true;\n\nexport const getEngagementEdge = (port?: undefined | string) => {\n    if (isLocal) {\n        return \"http://\" + window.location.hostname + (port || \":8900/\") \n    } else {\n        return \"__engagement_ux_standin__hostname__\"\n    }\n}\n\nconst graphql_edge = getEngagementEdge(\":5000/\");\n\nexport const retrieveGraph = async (lens: string): Promise<(LensScopeResponse & BaseNode)> => {\n    const query = expandScope(lens);\n\n    const res = await fetch(`${graphql_edge}graphql`,\n        {\n            method: 'post',\n            body: JSON.stringify({ query }),\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            credentials: 'include',\n        })\n        .then(res => res.json())\n        .then((res) => res.data)\n        .then((res) => res.lens_scope);\n\n    return (await res);\n};\n\nexport const expandScope = (lensName: string) => {\n    \n    const query = `\n    {\n        lens_scope(lens_name: \"${lensName}\") {\n            uid,\n            node_key,\n            lens_name,\n            dgraph_type,\n            scope {\n                ... on Process {\n                    uid,\n                    node_key, \n                    dgraph_type,\n                    process_name, \n                    process_id,\n                    children {\n                        uid, \n                        node_key, \n                        dgraph_type,\n                        process_name, \n                        process_id,\n                    }, \n                    risks {  \n                        uid,\n                        dgraph_type,\n                        node_key, \n                        analyzer_name, \n                        risk_score\n                    },\n                }\n            \n                ... on Asset {\n                    uid, \n                    node_key, \n                    dgraph_type,\n                    hostname,\n                    asset_ip{\n                        ip_address\n                    }, \n                    asset_processes{\n                        uid, \n                        node_key, \n                        dgraph_type,\n                        process_name, \n                        process_id,\n                    },\n                    files_on_asset{\n                        uid, \n                        node_key, \n                        dgraph_type,\n                        file_path\n                    }, \n                    risks {  \n                        uid,\n                        dgraph_type,\n                        node_key, \n                        analyzer_name, \n                        risk_score\n                    },\n                }\n\n                ... on File {\n                    uid,\n                    node_key, \n                    dgraph_type,\n                    risks {  \n                        uid,\n                        dgraph_type,\n                        node_key, \n                        analyzer_name, \n                        risk_score\n                    },\n                }\n            }\n        }\n    }\n`;\n\n    return query;\n}\n\n","import {VizGraph, VizNode} from '../../CustomTypes';\n\nexport const calcNodeRiskPercentile = (_nodeRisk: number | {risk: number}, _allRisks: any) => {\n    let nodeRisk = _nodeRisk;\n    if (typeof _nodeRisk === 'object') {\n        nodeRisk = _nodeRisk.risk;\n    }\n\n    const allRisks = _allRisks\n        .map((n: any) => n || 0)\n        .sort((a: number, b: number) => a - b);\n\n    if (nodeRisk === undefined || nodeRisk === 0 || allRisks.length === 0) {\n        return 0\n    }\n\n    let riskIndex = 0;\n    for (const risk of allRisks) {\n        if (nodeRisk >= risk) {\n            riskIndex += 1;\n        }\n    }\n\n    return Math.floor((riskIndex / allRisks.length) * 100)\n};\n\n\nexport const nodeSize = (node: VizNode, Graph: VizGraph) => {\n    const nodes = [...Graph.nodes].map(node => node.risk);\n    const riskPercentile = calcNodeRiskPercentile(node.risk, nodes);\n\n    if (riskPercentile >= 75) {\n        return 6\n    } else if (riskPercentile >= 25) {\n        return 5\n    } else {\n        return 4\n    }\n};\n","import { calcNodeRiskPercentile } from '../node/nodeCalcs'; \nimport { LinkType, VizNode, VizGraph } from '../../CustomTypes';\n\n\nconst findNode = (id: number, nodes: VizNode[]) => {\n    for (const node of (nodes || [])) {\n        if (node.id === id) {\n            return node\n        }\n    }\n    return null\n};\n\nexport const calcLinkRisk = (link: LinkType, Graph: VizGraph) => {\n    // console.log(\"LINK\", link)\n    let srcNode = \n        // findNode(link.source, Graph.nodes) || \n        findNode(link.source.name, Graph.nodes);\n    let dstNode = \n    // findNode(link.target, Graph.nodes)||\n        findNode(link.target.name, Graph.nodes);\n\n    if (!srcNode || !dstNode) {\n        console.error(\"Missing srcNode/dstNode\", srcNode, link, dstNode);\n        return 0;\n    }\n\n    const srcRisk = srcNode.risk || 0;\n    const dstRisk = dstNode.risk || 0;\n\n    return Math.round((srcRisk + dstRisk) / 2)\n};\n\nexport const calcLinkDirectionalArrowRelPos = (link: LinkType, Graph: VizGraph) => {\n    const node = \n    // findNode(link.target, Graph.nodes) || \n        findNode(link.target.name, Graph.nodes);\n\n    if (node === null || node.risk === 0) {\n        return 1.0\n    }\n    const nodes = [...Graph.nodes].map(node => node.risk);\n    const riskPercentile = calcNodeRiskPercentile(node.risk, nodes);\n\n    if (riskPercentile === 0) {\n        return 1.0\n    }\n\n    if (riskPercentile >= 75) {\n        return 0.95\n    } else if (riskPercentile >= 50) {\n        return 0.9\n    } else if (riskPercentile >= 25) {\n        return 0.85\n    } else {\n        return 1.0\n    }\n};\n\nexport const calcLinkRiskPercentile = (link: LinkType, Graph: VizGraph) => {\n    const linkRisk = calcLinkRisk(link, Graph);\n    const nodes = [...Graph.nodes].map(node => node.risk);\n\n    return calcNodeRiskPercentile(linkRisk, nodes);\n};\n\nexport const calcLinkParticleWidth = (link: LinkType, Graph:VizGraph) => {\n    const linkRiskPercentile = calcLinkRiskPercentile(link, Graph);\n    if (linkRiskPercentile >= 75) {\n        return 5\n    } else if (linkRiskPercentile >= 50) {\n        return 4\n    } else if (linkRiskPercentile >= 25) {\n        return 3\n    } else {\n        return 2\n    }\n};\n","import { calcNodeRiskPercentile } from '../calculations/node/nodeCalcs';\nimport { calcLinkRiskPercentile } from '../calculations/link/linkCalcs';\nimport { LinkType, VizGraph, VizNode } from '../CustomTypes'\nimport { ColorHash } from '../../../components/GraphViz';\n\nexport const BKDRHash = (str: string) => {\n    const seed = 131;\n    const seed2 = 137;\n    let hash = 0 as number;\n    // make hash more sensitive for short string like 'a', 'b', 'c'\n    str += 'x';\n    // Note: Number.MAX_SAFE_INTEGER equals 9007199254740991\n    const MAX_SAFE_INTEGER = parseInt(9007199254740991 / seed2 as any) as any;\n    for (let i = 0; i < str.length; i++) {\n        if (hash > MAX_SAFE_INTEGER) {\n            hash = parseInt(hash / seed2 as any);\n        }\n        hash = hash * seed + str.charCodeAt(i);\n    }\n    return hash;\n};\n\n//# TODO: Add custom coloring for each node\nexport const calcNodeRgb = (node: VizNode, colorHash: ColorHash) => {\n    if (node.nodeType === 'Process') {\n        return [31, 185, 128]\n    } else if (node.nodeType === 'File') {\n        return [177, 93, 255]\n    } \n    \n    // else if (node.nodeType === 'Lens'){\n    //     return []\n    // } else if(node.nodeType === 'IpPort'){\n    //     return []\n    // } else if(node.nodeType === 'IpConnection'){\n    //     return []\n    // } else if(node.nodeType === 'ProcessInboundConnection'){\n    //     return []\n    // } else if(node.nodeType === 'ProcessOutboundConnection'){\n    //     return []\n    // } \n    \n    else{\n        return colorHash.rgb(node.nodeType)\n    }\n}\n\n\nexport const percentToColor = (percentile: number) => {\n    const hue = (100 - percentile) * 40 / 100;\n\n    return `hsl(${hue}, 100%, 50%)`;\n};\n\nexport const calcLinkColor = (link: LinkType, Graph: VizGraph) => {\n    const risk = calcLinkRiskPercentile(link, Graph);\n    // Default link color if no risk\n    if (risk === 0) {\n        return 'white'\n    }\n    return percentToColor(risk);\n};\n\n\nexport const riskColor = (node: VizNode, Graph: VizGraph, colorHash: ColorHash) => {\n    const nodes = [...Graph.nodes].map(node => node.risk);\n\n    const riskPercentile = calcNodeRiskPercentile(node.risk, nodes);\n\n    if (riskPercentile === 0) {\n        const nodeColors = calcNodeRgb(node, colorHash);\n        return `rgba(${nodeColors[0]}, ${nodeColors[1]}, ${nodeColors[2]}, 1)`;\n    }\n\n    return percentToColor(riskPercentile);\n};\n\n\n","import {mapNodeProps} from '../../../../src/components/GraphViz';\nimport {Node, MergeGraphType} from '../CustomTypes'; \n\n// merges y into x, returns true if update occurred\nconst mergeNodes = (x: Node, y: Node) => {\n    let merged = false;\n    mapNodeProps(y, (prop: string) => {\n        if (!Object.prototype.hasOwnProperty.call(x, prop)) {\n            merged = true;\n            (x as any)[prop] = (y as any)[prop]\n        }\n    });\n\n    return merged;\n};\n\n// #TODO: This algorithm is exponential, and doesn't have to be\nexport const mergeGraphs = (curGraph: MergeGraphType, update: MergeGraphType): MergeGraphType | null => {\n    // Merges two graphs into a new graph\n    // returns 'null' if there are no updates to be made\n\n    if (!update.nodes && !update.links) {\n        // empty update\n        return null\n    }\n\n    const outputGraph: MergeGraphType = {nodes: [], links: []};\n\n    let updated = false;\n\n    const nodes = new Map();\n    const links = new Map();\n\n    for (const node of curGraph.nodes) {\n        nodes.set(node.uid, node)\n    }\n\n    for (const newNode of update.nodes) {\n        const node = nodes.get(newNode.uid);\n        if (node) {\n            if (mergeNodes(node, newNode)) {\n                updated = true;\n            }\n        } else {\n            nodes.set(newNode.uid, newNode);\n            updated = true;\n        }\n    }\n// #TODO: console.log on link.source, check to see if it's an object or not. It should never be an object\n// this should only be a string / an int. At some point, it was getting sent as an object\n    for (const link of curGraph.links) {\n        if (link) {\n            const source = link.source.uid || link.source;\n            const target = link.target.uid || link.target;\n            links.set(\n                source + link.label + target,\n                link,\n            )\n        }\n    }\n\n    for (const newLink of update.links) {\n        const newLinkSource =  newLink.source || newLink.source;\n        const newLinkTarget =  newLink.target || newLink.target;\n        const link = links.get(newLinkSource + newLink.label + newLinkTarget);\n        if (!link) {\n            links.set(newLink.source + newLink.label + newLink.target, newLink);\n            updated = true;\n        }\n    }\n\n    outputGraph.nodes = Array.from(nodes.values());\n    outputGraph.links = Array.from(links.values());\n    if (updated) {\n        return outputGraph;\n    } else {\n        return null;\n    }\n}","import { Node } from \"../CustomTypes\";\n\nconst _mapGraph = (node: Node, visited: Set<string>, f:(node:Node, prop:string, neighbor: Node) => void) => {\n    mapEdgeProps(node, (edgeName: string, neighbor:Node) => {\n        if (visited.has(node.uid + edgeName + neighbor.uid)) {\n            return\n        }\n\n        visited.add(node.uid + edgeName + neighbor.uid);\n\n        f(node, edgeName, neighbor);\n        _mapGraph(neighbor, visited, f)\n    })\n};\n\nexport const mapGraph = (node:Node, f:(node:Node, prop:string, neighbor: Node) => void) => {\n    const visited: Set<string> = new Set();\n    mapEdgeProps(node, (edgeName:string , neighbor:Node) => {\n\n        f(node, edgeName, neighbor);\n        _mapGraph(neighbor, visited, f)\n    })\n};\n\n// type fType = (prop:string, neighbor: Node) => void)\n// Given a node, call 'f' on any of its neighbors\nexport const mapEdges = (node: Node, f: (prop:string, neighbor: Node) => void) => {\n    for (const prop in node) {\n        if (Object.prototype.hasOwnProperty.call(node, prop)) {\n            if(Array.isArray((node as any)[prop])) {\n                for (const neighbor of (node as any)[prop]) {\n                    if (neighbor.uid !== undefined) {\n                        f(prop, neighbor)\n                    }\n                }\n            }\n        }\n    }\n};\n\nexport const mapEdgeProps = (node: Node, f: (prop:string, neighbor: Node) => void) => {\n    for (const prop in node) {\n        if (Object.prototype.hasOwnProperty.call(node, prop)) {\n            if(Array.isArray((node as any)[prop])) {\n                for (const neighbor of (node as any)[prop]) {\n                    if (neighbor.uid !== undefined) {\n                        f(prop, neighbor)\n                    }\n                }\n            }\n        }\n    }\n};\n\nexport const traverseNodes = (node: Node, callback: (node: Node) => void) => {\n    callback(node);\n    mapEdges(node, (_, neighbor) => {\n        traverseNodes(neighbor, callback);\n    })\n}\n\nexport const traverseNeighbors = (node: Node, callback: (node:Node, prop:string, neighbor: Node) => void) => {\n    mapEdges(node, (edgeName: string, neighbor: Node) => {\n        callback(node, edgeName, neighbor);\n\n        traverseNeighbors(neighbor, callback);\n    })\n}\n\n","import { traverseNodes, traverseNeighbors, mapEdges } from \"../graph/graph_traverse\"\nimport { getNodeLabel } from '../graph/labels';\nimport {LensScopeResponse, BaseNode} from \"../../GraphViz/CustomTypes\"\n\ninterface IVizNode {\n    uid: number,\n    name: number,\n    id: number, \n    nodeType: string,\n    nodeLabel: string,\n    x: number,\n    y: number,\n}\n\ninterface VizProcessNode extends IVizNode {\n    process_id: number,\n    process_name: string,\n    created_timestamp: number, \n    terminate_time: number,\n    image_name: string, \n    arguments: string,\n}\n\nexport interface File extends IVizNode {\n    file_name: string,\n    file_path: string,\n    file_extension: string,\n    file_mime_type: string,\n    file_size: number,\n    file_version: string, \n    file_description: string,\n    file_product: string,\n    file_company: string, \n    file_directory: string,\n    file_inode: number,\n    file_hard_links: string, \n    signed: boolean,\n    signed_status: string, \n    md5_hash: string,\n    sha1_hash: string,\n    sha256_hash: string,\n}\n\nexport interface IpConnections extends IVizNode {\n    src_ip_addr: string,\n    src_port: string,\n    dst_ip_addr: string,\n    dst_port: string,\n    created_timestamp: number,\n    terminated_timestamp: number,\n    last_seen_timestamp: number,\n}\ninterface VizAssetNode extends IVizNode {\n    hostname: string,\n}\n\ninterface VizLensNode extends IVizNode {\n    lens_name: string,\n}\n\ntype VizDynamicNode = IVizNode;\n\ntype VizNode = VizProcessNode | VizAssetNode | VizLensNode | VizDynamicNode;\n\ntype VizLink = {\n    source: number,\n    label: string,\n    target: number, \n}\n\ntype AdjacencyMatrix = {\n    nodes: VizNode[],\n    links: VizLink[]\n}\n\n\nconst getNodeType = (node: BaseNode) => {\n    const t = node.dgraph_type || node.node_type;\n\n    if (t) {\n        if (Array.isArray(t)) {\n            return t[0]\n        }\n        return t\n    }\n\n    console.warn('Unable to find type for node ', node);\n    return 'Unknown';\n};\n\nfunction randomInt(min: number, max: number) // min and max included\n{\n    let randomNum: number = Math.floor(Math.random() * (max - min + 1) + min);\n    return randomNum;\n}\n\n\nexport const graphQLAdjacencyMatrix = (inputGraph: (LensScopeResponse & BaseNode)): AdjacencyMatrix => {\n\n    const nodes: VizNode[] = []; \n    const links: VizLink[] = []; \n\n    traverseNeighbors(inputGraph, \n        (fromNode: BaseNode, edgeName: string, toNode: BaseNode) => {\n            if(edgeName !== 'scope'){\n                \n                if(getNodeType(fromNode) === 'Unknown'){\n                    return;\n                }\n\n                if(getNodeType(toNode) === 'Unknown'){\n                    return;\n                }\n\n                if(getNodeType(fromNode) === 'Risk'){\n                    return;\n                }\n\n                if(getNodeType(toNode) === 'Risk'){\n                    return;\n                }\n                \n                links.push({\n                    source: fromNode.uid,\n                    label: edgeName, \n                    target: toNode.uid\n                })\n        } \n    })\n\n    traverseNodes(inputGraph, (node: BaseNode) => {\n        const nodeType = getNodeType(node);\n\n        if(nodeType === 'Unknown'){\n            return;\n        }\n\n        if(nodeType === 'Risk'){\n            return; \n        }\n\n        const nodeLabel = getNodeLabel(nodeType, node);\n\n        const strippedNode = {...node};\n\n        strippedNode.risk = strippedNode.risk || 0;\n        strippedNode.analyzer_names = strippedNode.analyzer_names || \"\";\n\n        for(const risk of node.risks || []){\n            strippedNode.risk += risk.risk_score || 0;\n            strippedNode.analyzer_names += risk.analyzer_name || \"\";\n        }\n\n        mapEdges(node, (edge: string, neighbor: BaseNode) => {\n            // The stripped node is being converted to another type, so we can cast\n            // to any here\n            (strippedNode as any)[edge] = undefined;\n        })\n        \n        nodes.push({\n            name: node.uid,\n            id: node.uid,\n            ...strippedNode,\n            nodeType,\n            nodeLabel,\n            x: 200 + randomInt(1, 50),\n            y: 150 + randomInt(1, 50),\n        })\n    })\n\n    return {\n        nodes, \n        links\n    }\n}\n","import { Node }  from '../CustomTypes'\n\nconst getNodeLabel = (nodeType: string, node: Node) => {\n    console.log('nodetype', nodeType);\n\n    const _node = node as any; // ignore-any\n\n    switch(nodeType) {\n        case \"Process\": return _node.process_name || _node.process_id || 'Process';\n        case \"Asset\": return _node.hostname || 'Asset';\n        case \"File\": return _node.file_path || 'File';\n        case \"IpAddress\": return _node.external_ip || 'IpAddress';\n        case \"Lens\":  return _node.lens || 'Lens';\n        default: return nodeType || '';\n    }\n};\n\nconst mapLabel = (label: string) => {\n    if (label === 'children') {\n        return 'executed'\n    }\n    return label\n};\n\nexport { mapLabel, getNodeLabel }","// @ts-nocheck\nimport React, { useEffect, useRef } from 'react';\nimport { ForceGraph2D } from 'react-force-graph';\nimport * as d3 from \"d3\";\nimport { BKDRHash, riskColor, calcNodeRgb , calcLinkColor} from \"../modules/GraphViz/graphColoring/coloring.tsx\";\nimport { getEngagementEdge, retrieveGraph } from '../modules/GraphViz/graphQL/expandScope.tsx';\nimport { mapLabel } from '../modules/GraphViz/graph/labels.tsx';\nimport { nodeSize } from '../modules/GraphViz/calculations/node/nodeCalcs.tsx'\nimport { calcLinkDirectionalArrowRelPos, calcLinkParticleWidth  } from '../modules/GraphViz/calculations/link/linkCalcs.tsx'\nimport {mergeGraphs} from '../modules/GraphViz/graph/mergeGraphs.tsx'\nimport {graphQLAdjacencyMatrix} from '../modules/GraphViz/graphQL/graphQLAdjacencyMatrix.tsx'\nimport { Node, LinkType, GraphType, ColorHashOptions } from \"../modules/GraphViz/CustomTypes\"\n\ntype ColorHashOptions = {\n    lightness: number,\n    saturation: number,\n    hue: number,\n    hash: BKDRHash,\n}\n\n/**\n * Convert HSL to RGB\n *\n * @see {@link http://zh.wikipedia.org/wiki/HSL和HSV色彩空间} for further information.\n * @param {Number} H Hue ∈ [0, 360)\n * @param {Number} S Saturation ∈ [0, 1]\n * @param {Number} L Lightness ∈ [0, 1]\n * @returns {Array} R, G, B ∈ [0, 255]\n */\nconst HSL2RGB = (H: number, S: number, L: number) => {\n    H /= 360;\n\n    const q = L < 0.5 ? L * (1 + S) : L + S - L * S;\n    const p = 2 * L - q;\n\n    return [H + 1 / 3, H, H - 1 / 3].map((color) => {\n        if (color < 0) {\n            color++;\n        }\n        if (color > 1) {\n            color--;\n        }\n        if (color < 1 / 6) {\n            color = p + (q - p) * 6 * color;\n        } else if (color < 0.5) {\n            color = q;\n        } else if (color < 2 / 3) {\n            color = p + (q - p) * 6 * (2 / 3 - color);\n        } else {\n            color = p;\n        }\n        return Math.round(color * 255);\n    });\n};\n\nconst isArray = (o: Object) => {\n    return Object.prototype.toString.call(o) === '[object Array]';\n};\n\n/**\n * Color Hash Class\n *\n * @class\n */\n\nexport class ColorHash {\n    constructor(options: ColorHashOptions | undefined) {\n        options = options || {};\n\n        const LS = [options.lightness, options.saturation].map((param) => {\n            param = param || [0.35, 0.5, 0.65]; // note that 3 is a prime\n            return isArray(param) ? param.concat() : [param];\n        });\n    \n        this.L = LS[0];\n        this.S = LS[1];\n    \n        if (typeof options.hue === 'number') {\n            options.hue = {min: options.hue, max: options.hue};\n        }\n        if (typeof options.hue === 'object' && !isArray(options.hue)) {\n            options.hue = [options.hue];\n        }\n        if (typeof options.hue === 'undefined') {\n            options.hue = [];\n        }\n        this.hueRanges = options.hue.map(function (range: number) {\n            return {\n                min: typeof range.min === 'undefined' ? 0 : range.min,\n                max: typeof range.max === 'undefined' ? 360 : range.max\n            };\n        });\n    \n        this.hash = options.hash || BKDRHash;\n    } \n    /**\n     * Returns the hash in [h, s, l].\n     * Note that H ∈ [0, 360); S ∈ [0, 1]; L ∈ [0, 1];\n     *\n     * @param {String} str string to hash\n     * @returns {Array} [h, s, l]\n     */\n    hsl = (str: string) => {\n        let H, S, L;\n        let hash = this.hash(str);\n    \n        if (this.hueRanges.length) {\n            const range = this.hueRanges[hash % this.hueRanges.length];\n            const hueResolution = 727; // note that 727 is a prime\n            H = ((hash / this.hueRanges.length) % hueResolution) * (range.max - range.min) / hueResolution + range.min;\n        } else {\n            H = hash % 359; // note that 359 is a prime\n        }\n        hash = parseInt(hash / 360 as any);\n        S = this.S[hash % this.S.length];\n        hash = parseInt(hash / this.S.length as any);\n        L = this.L[hash % this.L.length];\n    \n        return [H, S, L];\n    }\n\n    /**\n     * Returns the hash in [r, g, b].\n     * Note that R, G, B ∈ [0, 255]\n     *\n     * @param {String} str string to hash\n     * @returns {Array} [r, g, b]\n     */\n    rgb = (str: string) => {\n        const hsl = this.hsl(str);\n        return HSL2RGB.apply(this, hsl);\n    };\n}\n\n\nexport const mapNodeProps = (node: Node, f: (string) => void) => {\n    for (const prop in node) {\n        if (Object.prototype.hasOwnProperty.call(node, prop)) {\n            if (Array.isArray(node[prop])) {\n                if (node[prop].length > 0) {\n                    if (node[prop][0].uid === undefined) {\n                        f(prop)\n                    }\n                }\n            } else {\n                f(prop)\n            }\n        }\n    }\n};\n\ntype GraphState = {\n    curLensName: LensType[], \n    graphData: GraphType[]\n}\n\nconst updateGraph = async (\n    lensName: string, \n    state: GraphState, \n    setState: (state: GraphState) => void,\n) => {\n    if (!lensName) {\n        return;\n    }\n\n    await retrieveGraph(lensName)\n        .then(async (scope) => {\n            const update = graphQLAdjacencyMatrix(scope);\n            console.log('update', update);\n            const mergeUpdate = mergeGraphs(state.graphData, update);\n            if (mergeUpdate !== null) {\n                if (state.curLensName === lensName) {\n                    setState({\n                        ...state,\n                        curLensName: lensName,\n                        graphData: mergeUpdate,\n                    })\n                } else {\n                    setState({\n                        ...state,\n                        curLensName: lensName,\n                        graphData: update,\n                    })\n                }\n            }\n        })\n        .catch((e) => console.error(\"Failed to retrieveGraph \", e))\n}\n\ntype GraphDisplayProps = {\n    lensName: string | null,\n    setCurNode: (string) => void,\n}\n\ntype GraphDisplayState = {\n    graphData: AdjacencyMatrix,\n    curLensName: string | null,\n}\n\nconst defaultGraphDisplayState = (lensName: string): GraphDisplayState => {\n    return {\n        graphData: {nodes: [], links: []},\n        curLensName: lensName,\n    }\n}\n\nconst GraphDisplay = ({lensName, setCurNode}: GraphDisplayProps) => {\n    const [state, setState] = React.useState(defaultGraphDisplayState(lensName));\n    const forceRef = useRef(null);\n\n    useEffect(() => {\n        // console.log(\"useEffect - setting forceRef state\");\n        forceRef.current.d3Force(\"link\", d3.forceLink());\n        forceRef.current.d3Force('collide', d3.forceCollide(22));\n        forceRef.current.d3Force(\"charge\", d3.forceManyBody());\n        forceRef.current.d3Force('box', () => {\n            const N = 100;\n            // console.log(Graph.width(), Graph.height())\n            const SQUARE_HALF_SIDE = 20 * N * 0.5;\n            state.graphData.nodes.forEach(node => {\n                const x = node.x || 0, y = node.y || 0;\n                // bounce on box walls\n                if (Math.abs(x) > SQUARE_HALF_SIDE) {\n                    node.vx *= -1;\n                }\n                if (Math.abs(y) > SQUARE_HALF_SIDE) {\n                    node.vy *= -1;\n                }\n            });\n        });\n    }, [state])\n\n\n    useEffect(() => {\n        updateGraph(lensName, state, setState);\n        const interval = setInterval(async () => {\n            if (lensName) {\n                await updateGraph(lensName, state, setState);\n            }\n        }, 1000);\n        return () => clearInterval(interval);\n    }, [lensName, state]);\n\n    const graphData = state.graphData;\n\n    const colorHash = new ColorHash({});\n\n    // #TODO: ADD ZOOM HANDLERS FOR MAX ZOOM IN/OUT\n\n    return (\n        <>\n            <ForceGraph2D\n                graphData={graphData}\n                nodeLabel={(node: Node) => node.nodeLabel}\n                enableNodeDrag={true}\n                linkDirectionalParticles={1}\n                linkDirectionalParticleWidth={(link) => {\n                    return calcLinkParticleWidth(link, graphData);\n                }}\n                linkDirectionalParticleColor={(link) => {\n                    return calcLinkColor(link, graphData)\n                }}\n                linkDirectionalParticleSpeed={0.005}\n                onNodeClick={\n                    (node: Node, event: string) => {\n                        setCurNode(node);\n                    }\n                }\n                linkDirectionalArrowLength={8}\n                linkWidth={4}\n                linkDirectionalArrowRelPos={(link => {\n                    return calcLinkDirectionalArrowRelPos(link, graphData);\n                })}\n                linkCanvasObjectMode={(() => 'after')}\n                linkCanvasObject={((link: LinkType, ctx: any) => {\n                    const MAX_FONT_SIZE = 8;\n                    const LABEL_NODE_MARGIN = 8 * 1.5;\n                    const start = link.source;\n                    const end = link.target;\n                    // ignore unbound links\n                    link.color = calcLinkColor(link, graphData);\n\n                    if (typeof start !== 'object' || typeof end !== 'object') return;\n                    // calculate label positioning\n                    const textPos = Object.assign(\n                        ...['x', 'y'].map((c: any) => (\n                            {\n                                [c]: start[c] + (end[c] - start[c]) / 2 // calc middle point\n                            }\n                        )) as any\n                    );\n\n                    const relLink = {x: end.x - start.x, y: end.y - start.y};\n\n                    const maxTextLength = Math.sqrt(Math.pow(relLink.x, 2) + Math.pow(relLink.y, 2)) - LABEL_NODE_MARGIN * 8;\n\n                    let textAngle = Math.atan2(relLink.y, relLink.x);\n                    // maintain label vertical orientation for legibility\n                    if (textAngle > Math.PI / 2) textAngle = -(Math.PI - textAngle);\n                    if (textAngle < -Math.PI / 2) textAngle = -(-Math.PI - textAngle);\n\n                    const label = mapLabel(link.label);\n                    // estimate fontSize to fit in link length\n                    ctx.font = '50px Arial';\n                    const fontSize = Math.min(MAX_FONT_SIZE, maxTextLength / ctx.measureText(label).width);\n                    ctx.font = `${fontSize + 5}px Arial`;\n\n                    let textWidth = ctx.measureText(label).width;\n\n                    textWidth += Math.round(textWidth * 0.25);\n\n                    const bckgDimensions = [textWidth, fontSize].map(n => n + fontSize * 0.2); // some padding\n                    // draw text label (with background rect)\n                    ctx.save();\n                    ctx.translate(textPos.x, textPos.y);\n                    ctx.rotate(textAngle);\n                    ctx.fillStyle = 'rgb(115,222,255,1)';\n                    ctx.fillRect(-bckgDimensions[0] / 2, -bckgDimensions[1] / 2, ...bckgDimensions);\n                    ctx.textAlign = 'center';\n                    ctx.textBaseline = 'middle';\n                    ctx.fillStyle = 'white';\n                    //content, left/right, top/bottom\n                    ctx.fillText(label, .75, 3);\n                    ctx.restore();\n                })}\n                nodeCanvasObject={((node: Node, ctx: any, globalScale: any) => {\n                    // add ring just for highlighted nodes\n\n                    const NODE_R = nodeSize(node, graphData);\n                    ctx.save();\n\n                    // Risk outline color\n                    ctx.beginPath();\n                    ctx.arc(node.x, node.y, NODE_R * 1.3, 0, 2 * Math.PI, false);\n                    ctx.fillStyle = riskColor(node, graphData, colorHash);\n                    ctx.fill();\n                    ctx.restore();\n\n                    ctx.save();\n\n                    // Node color\n                    ctx.beginPath();\n                    ctx.arc(node.x, node.y, NODE_R * 1.2, 0, 2 * Math.PI, false);\n\n                    const nodeRbg = calcNodeRgb(node, colorHash);\n\n                    ctx.fillStyle = `rgba(${nodeRbg[0]}, ${nodeRbg[1]}, ${nodeRbg[2]}, 1)`;\n                    ctx.fill();\n                    ctx.restore();\n\n                    const label = node.nodeLabel;\n\n                    const fontSize = 15 / globalScale;\n\n                    ctx.font = `${fontSize}px Arial`;\n\n\n                    const textWidth = ctx.measureText(label).width;\n\n                    const bckgDimensions = [textWidth, fontSize].map(n => n + fontSize * 0.2); // some padding\n                    // node label color\n                    ctx.fillStyle = 'rgba(48, 48, 48, 0.8)';\n                    ctx.fillRect(node.x - bckgDimensions[0] / 2, node.y - bckgDimensions[1] / 2, ...bckgDimensions);\n                    ctx.textAlign = 'center';\n                    ctx.textBaseline = 'middle';\n                    ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\n                    ctx.fillStyle = 'white';\n                    ctx.fillText(label, node.x, node.y);\n\n                })}\n                ref={forceRef}\n            />\n        </>\n    )\n}\n\nexport default GraphDisplay;\n","import React from \"react\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport { mapEdgeProps } from '../modules/GraphViz/graph/graph_traverse';\nimport {mapNodeProps} from './GraphViz';\nimport {Node} from \"../modules/GraphViz/CustomTypes\"\n\n\nconst useStyles = makeStyles({\n    root: {\n        fontSize: \"1em\"\n    },\n    table: {\n        minWidth: 450,\n    }, \n    tableHeader: {\n        fontSize: \"18px\", \n        color: \"#EAFDFF\", \n    }\n});\n\nfunction innerTable(node: Node, styles: any) {\n    if(node) {\n        return (\n        <TableHead >\n            <TableRow>\n                <TableCell \n                    align=\"left\" \n                    className={styles.tableHeader}>\n                    <b> PROPERTY </b>\n                </TableCell>\n                <TableCell \n                    align=\"left\"\n                    className={styles.tableHeader}\n                >\n                    <b> VALUE </b>\n                </TableCell>\n            </TableRow>\n        </TableHead>\n    )\n    } else {\n        return <></>\n    }\n}\n\ntype NodeTableProps = {\n    node: Node\n}\n\nfunction NodeTable({node}: NodeTableProps){\n    const classes = useStyles();\n    const hidden = new Set(\n        ['id', 'dgraph.type', '__indexColor', 'risks','uid', 'scope', 'name', 'nodeType', 'nodeLabel', 'x', 'y', 'index', 'vy', 'vx', 'fx', 'fy']\n    );\n\n    mapEdgeProps(node, (edgeName: string, _neighbor: Node) => {\n        hidden.add(edgeName)\n    });\n\n    const displayNode = {} as any;\n\n    mapNodeProps(\n        node, \n        (propName: string) => {\n            const prop = (node as any)[propName];\n\n            if(!hidden.has(propName)){\n                if (prop) {\n                    if (propName.includes('_time')) {\n                        displayNode[propName] = new Date(prop).toLocaleString()\n                    } else {\n                        displayNode[propName] = prop;\n                    }\n                }\n            }           \n        }\n    )\n\n        return(\n            <TableContainer>\n                <Table className={classes.table}>\n                {\n                    innerTable(node, classes)\n                }\n                <TableBody>\n                        {\n                            Object.entries(displayNode).map((entry) => {\n                                const [key, value] = entry;\n                                \n                                return(\n                                    <TableRow>\n                                        <TableCell align=\"left\"><b>{key}</b></TableCell>\n                                        <TableCell align=\"left\">{value as any}</TableCell>\n                                    </TableRow>\n                                ) \n                            })\n                        }\n                </TableBody>\n                </Table>\n            </TableContainer>\n        ) || \"no no\"\n        \n    \n}\n\n\nexport default  NodeTable ","import React, {useEffect, useState} from \"react\";\nimport NodeTable from './NodeTable'\nimport Button from \"@material-ui/core/Button\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport BubbleChartIcon from '@material-ui/icons/BubbleChart';\nimport LensIcon from '@material-ui/icons/Lens';\nimport Divider from \"@material-ui/core/Divider\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport {mapEdgeProps} from '../modules/GraphViz/graph/graph_traverse'; \nimport {Node, Lens} from \"../modules/GraphViz/CustomTypes\";\n\n\nconst useStyles = makeStyles({\n    root:{\n        fontSize: \"1rem\",\n    },\n    button: {\n        width: \".005%\",\n        color: \"white\",\n        backgroundColor:\"#424242\",\n    },\n    title: {\n        fontSize: \"25px\",\n        color: \"#ffffff\",\n    },\n    icon:{\n        color: \"#42C6FF\",\n        margin: \"15px 0 0 10px\",\n    }, \n    expand:{\n        color: \"#42C6FF\",\n        margin: \"0px\"\n    },\n    header:{\n        display: \"flex\"\n    }, \n    table: {\n        minWidth: 450\n    },\n});\n\ntype SelectLensProps = {\n    lens: string,\n    score: number,\n    uid: number,\n    setLens: (lens: string) => void,\n}\n\nfunction SelectLens(props: SelectLensProps) {\n    // lensRows.push(createData(props.setLens(props.lens) ))\n    return (\n        <>\n                <TableRow key={props.lens}>\n                        <TableCell component=\"th\" scope=\"row\">\n                        <Button \n                            onClick={\n                                () => { \n                                    props.setLens(props.lens)    \n                                }\n                        }>\n                            {props.lens + \"\\t\\t\" + props.score}\n                        </Button>\n                        </TableCell>\n                    </TableRow>\n        </>\n    )\n}\n\n\ntype ToggleLensTableProps = {\n    setLens: (lens: string) => void,\n}\n\ntype ToggleLensTableState = {\n    toggled: boolean,\n    lenses: Lens[],\n}\n\nconst defaultToggleLensTableState = (): ToggleLensTableState => {\n    return {\n        toggled: true,\n        lenses: [],\n    }\n}\n\nfunction ToggleLensTable({setLens}: ToggleLensTableProps) {\n    const [state, setState] = useState(defaultToggleLensTableState());\n\n    const classes = useStyles();\n\n    useEffect(() => {\n        const interval = setInterval(() => {\n            console.log(\"Fetching lenses\");\n            getLenses()\n                .then((response) => {\n                    if (response.lenses && response.lenses !== state.lenses) {\n                        setState({\n                            ...state,\n                            lenses: response.lenses || [],\n                        })\n                    }\n                })\n        }, 1000);\n        return () => clearInterval(interval);\n    });\n\n\n    return (\n        <>\n            <div className={classes.header}>\n                <b className={classes.title}>\n                    <BubbleChartIcon className = {classes.icon} />\n                    LENSES \n                </b>\n                <Button\n                    className = {classes.button}\n                    onClick={() => { \n                        setState({\n                            ...state,\n                            toggled: !state.toggled,\n                        }) \n                    }}> \n                    <ExpandMoreIcon className={classes.expand}/> \n                </Button>\n            </div>\n\n            <div className=\"lensToggle\">\n                {state.toggled && state.lenses &&\n                    state.lenses.map(\n                        (lens: Lens) => {\n                            // lensRows.push(lens);\n                            return(\n                                <TableContainer>\n                                    <Table className={classes.table} aria-label=\"lens table\">\n                                        <TableBody>\n                                            <SelectLens \n                                                key={Number(lens.uid)}\n                                                uid={lens.uid}\n                                                lens={lens.lens_name}\n                                                score={lens.score}\n                                                setLens={setLens}\n                                            />\n                                        </TableBody>\n                                    </Table>\n                                </TableContainer>\n                            )\n                        }\n                    )\n                }\n            </div>\n            \n            <Divider />\n        </>\n    )\n}\n\nconst isLocal = true;\n\nconst getEngagementEdge = (port?: undefined | string) => {\n    if (isLocal) {\n        return \"http://\" + window.location.hostname + (port || \":8900/\")\n    } else {\n        return \"__engagement_ux_standin__hostname__\"\n    }\n}\n\n// const engagement_edge = getEngagementEdge();\nconst graphql_edge = getEngagementEdge(\":5000/\");\n\n\nconst getLenses = async () => {\n    console.log('fetching graph from', graphql_edge);\n\n    const query = `\n    {\n        lenses {\n            uid,\n            node_key,\n            lens_name,\n            score\n        }\n    }\n    `;\n    \n    const res = await fetch(`${graphql_edge}graphql`,\n        {\n            method: 'post',\n            body: JSON.stringify({ query: query }),\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            credentials: 'include',\n        })\n        .then(res => res.json())\n        .then(res => {\n            if (res.errors) {\n                console.error(\"lenses failed\", res.errors);\n            }\n            res.data = {lenses: []};\n            return res\n        })\n        .then((res) => res.data);\n\n        const jres = await res;\n\n    return jres;\n};\n\ntype NodeDetailsProps = {\n    node: Node\n}\n\nconst NodeDetails = ({node}: NodeDetailsProps) => {\n    // #TODO: Remove hidden fields from our node before displaying\n    // Display remaining fields of node in our component=\"div\"\n\n    return (\n        <>\n            <NodeTable node={node} />\n        </>\n    )\n}\n\ntype ToggleNodeTableProps = {\n    curNode: Node | null\n}\n\nfunction ToggleNodeTable({curNode}: ToggleNodeTableProps) {\n    const [toggled, toggle] = useState(true);\n    const classes = useStyles();\n    return (\n        <>\n        <div>\n            <div className={classes.header}>\n                <b className={classes.title}><LensIcon className={classes.icon}/> NODE</b>\n                <Button\n                    className = {classes.button}\n                    onClick={\n                        () => { toggle(toggled => !toggled) }\n                    }> \t\n                    <ExpandMoreIcon className={classes.expand}/> \n                </Button>\n            </div>\n\n            <div className=\"nodeToggle\">\n                {\n                    toggled && curNode && \n                        <>\n                            { <NodeDetails node={curNode}/> }\n                        </>\n                }\n            </div>\n        </div>\n        </>\n    )\n}\n\n\ntype SideBarContentProps = {\n    setLens: (lens: string) => void, \n    curNode: Node | null\n}\n\nexport default function SideBarContent({setLens, curNode}: SideBarContentProps) {\n    return (\n        <>\n            <ToggleLensTable setLens={setLens}/>\n            <ToggleNodeTable curNode={curNode}/>\n        </>\n    );\n}\n\n","import GraphDisplay from \"./GraphViz\";\nimport React from \"react\";\nimport SideBarContent from './SideBarContent'\nimport clsx from \"clsx\";\nimport {createStyles, makeStyles, Theme} from \"@material-ui/core/styles\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Divider from \"@material-ui/core/Divider\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport KeyboardArrowLeftIcon from '@material-ui/icons/KeyboardArrowLeft';\nimport Button from \"@material-ui/core/Button\";\nimport { Node, Lens } from \"../modules/GraphViz/CustomTypes\";\n\nconst drawerWidth = 500;\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      display: \"flex\"\n    },\n    appBar: {\n      transition: theme.transitions.create([\"margin\", \"width\"], {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.leavingScreen\n      })\n    },\n    appBarShift: {\n      width: `calc(100% - ${drawerWidth}px)`,\n      marginLeft: drawerWidth,\n      transition: theme.transitions.create([\"margin\", \"width\"], {\n        easing: theme.transitions.easing.easeOut,\n        duration: theme.transitions.duration.enteringScreen\n      })\n    },\n    menuButton: {\n      marginRight: theme.spacing(2),\n      color: \"#42C6FF\"\n    },\n    hide: {\n      display: \"none\"\n    },\n    drawer: {\n      width: drawerWidth,\n      flexShrink: 0\n    },\n    drawerPaper: {\n      width: drawerWidth\n    },\n    drawerHeader: {\n      display: \"flex\",\n      alignItems: \"center\",\n      padding: theme.spacing(0, 1),\n      // necessary for content to be below app bar\n      ...theme.mixins.toolbar,\n      justifyContent: \"flex-end\"\n    },\n    content: {\n      flexGrow: 1,\n      padding: theme.spacing(3),\n      transition: theme.transitions.create(\"margin\", {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.leavingScreen\n      }),\n      marginLeft: -drawerWidth\n    },\n    contentShift: {\n      transition: theme.transitions.create(\"margin\", {\n        easing: theme.transitions.easing.easeOut,\n        duration: theme.transitions.duration.enteringScreen\n      }),\n      marginLeft: 0,\n    },\n    lensName:{\n      color:\"#EAFDFF\",\n      fontSize: \"2rem\", \n      margin: \"10px 15px 0px 0px\"\n    },\n    header:{\n      fontSize: \"35px\"\n    }, \n    close:{\n      color:\"#42C6FF\",\n    }\n  })\n);\n\ntype SideBarProps = {\n  setLens: (lens: string) => void,\n  curLens: string,\n  curNode: Node | null,\n}\n\nexport default function SideBar({setLens, curLens, curNode}: SideBarProps) {\n  const classes = useStyles();\n\n  const [open, setOpen] = React.useState(true);\n\n  const handleDrawerOpen = () => {\n    setOpen(true);\n  };\n\n  const handleDrawerClose = () => {\n    setOpen(false);\n  };\n\n  return (\n    <div className={classes.root}>\n      {/* <CssBaseline /> */}\n      <AppBar\n        position=\"fixed\"\n        className={clsx(classes.appBar, {\n          [classes.appBarShift]: open\n        })}\n      >\n        <Toolbar>\n          <IconButton\n            color=\"inherit\"\n            aria-label=\"open drawer\"\n            onClick={handleDrawerOpen}\n            edge=\"start\"\n            className={clsx(classes.menuButton, open && classes.hide)}\n          >\n            {/* // Menu Icon  */}\n            &#9776;\n          </IconButton>\n          <Typography \n            variant=\"h5\" \n            noWrap\n          >\n            <b className={classes.header}> GRAPL</b>\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <Drawer\n        className={classes.drawer}\n        variant=\"persistent\"\n        anchor=\"left\"\n        open={open}\n        classes={{\n          paper: classes.drawerPaper\n        }}\n      >\n        <div className={classes.drawerHeader}>\n          <Button onClick={handleDrawerClose}><KeyboardArrowLeftIcon className={classes.close}/></Button>\n        </div>\n\n        <Divider />\n\n        <SideBarContent \n        setLens={setLens} \n        curNode={curNode}\n      />\n\n      </Drawer>\n\n      <main\n        className={clsx(classes.content, {\n          [classes.contentShift]: open\n        })}\n      >\n        <div className={ classes.drawerHeader } />\n      <h3 className={ classes.lensName }>\n        {/* selected lens name */}\n        {curLens || \"\"} \n      </h3>\n\n        <Typography paragraph></Typography>\n      </main>\n    </div>\n  );\n}\n\ntype EngagementUxState = {\n  curLens: string, \n  curNode: Node | null \n}\n\nconst defaultEngagementUxState = (): EngagementUxState => {\n  return {\n    curLens: \"\",\n    curNode: null,\n  }\n}\n\nexport const EngagementUx = () => {\n    \n    const [state, setState] = React.useState(defaultEngagementUxState());\n    \n    console.log('EngagementUX: curLens, ', state.curLens);\n\n    return (\n        <>\n            <SideBar \n                setLens={\n                    (lens: string) => setState({\n                        ...state,\n                        curLens: lens,\n                    })\n                }\n                curLens={state.curLens}\n                curNode={state.curNode}\n            />\n\n            <GraphDisplay \n                lensName={state.curLens} \n                setCurNode={(node: Node) => {\n                    setState({\n                        ...state,\n                        curNode: node,\n                    })\n                }}\n            />\n        </>\n    )\n}","import React, {useEffect} from 'react';\nimport './LogIn.css';\nimport {checkLogin, LogIn} from './Login';\nimport {EngagementUx} from \"./components/SideBar\";\nimport { RouteState, SetRouteState } from '../src/modules/GraphViz/CustomTypes'\n\nconsole.log(\"App loading\");\n\n// Updates our react state, as well as localStorage state, to reflect the page\n// we should render\n\nconst redirectTo = (\n    routeState: RouteState, \n    setRouteState: SetRouteState, \n    page_name: string\n    ) => {\n    setRouteState({\n        ...routeState,\n        curPage: page_name,\n    })\n    localStorage.setItem(\"grapl_curPage\", page_name)\n}\n\nconst defaultRouteState = (): RouteState => {\n    return {\n        curPage: localStorage.getItem(\"grapl_curPage\") || \"login\",\n        lastCheckLoginCheck: Date.now(),\n    }\n}\n\nconst Router = () => {\n    // By default, load either the last page we were on, or the login page\n    // if there is no last page\n    const [routeState, setRouteState] = React.useState(defaultRouteState())\n\n    useEffect(() => {\n        if (routeState.curPage !== \"login\") {\n            if (Date.now() - routeState.lastCheckLoginCheck > 1000) {\n                checkLogin()\n                    .then((loggedIn) => {\n                        console.log('Not logged in, redirecting.');\n                        if (!loggedIn && routeState.curPage !== \"login\") {\n                            redirectTo(routeState, setRouteState, \"login\")\n                        }\n                    })\n            }}\n    });\n\n    if (routeState.curPage === \"login\") {\n        console.log(\"routing to engagement_ux page\");\n        return (\n            <LogIn loginSuccess={\n                () => redirectTo(routeState, setRouteState, \"engagement_ux\")\n            }></LogIn>\n        )\n    }\n\n    if (routeState.curPage === \"engagement_ux\") {\n        console.log(\"routing to login page\");\n        return <EngagementUx/>\n    }\n\n    // #TODO: This should be a nice landing page explaining that something has gone\n    // wrong, and give a redirect back to the login page\n    console.warn(\"Invalid Page State\");\n    return <div>Invalid Page State</div>\n    // <PageNotFound />\n}\n\n\nexport default function App() {\n    console.log(\"App loaded\");\n    return (\n        <>\n            <Router/>\n        </>\n    )\n}\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles'\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\n\nconst darkTheme = createMuiTheme({\n    palette: {\n        type: 'dark',\n        primary: {\n            main: '#373740',\n        }\n    }\n})\n\nconst rootElement = document.getElementById('root')\n\nReactDOM.render(\n    <React.StrictMode>\n    <ThemeProvider theme={darkTheme}>\n        <App />, \n    </ThemeProvider>\n    </React.StrictMode>\n    ,\n    rootElement\n);\n\nserviceWorker.unregister();\n"],"sourceRoot":""}